# ðŸš– TaxiTub MVP â€“ Functional Blueprint

---

## 1. Actors

* **Admin**
  Manages car database, views queues & active trips.
* **QueuePal**
  Adds cars to queues, sees live queue status.
* **Passenger**
  Requests taxi â†’ system assigns car.

---

## 2. Core Concepts

### Entities

* **Car**
  Holds permanent info about taxi (plate, driver, seater, etc.).
* **Queue**
  Temporary holding area for cars waiting for assignment.

  * Organized **per seater**.
  * Operates **FIFO**.
* **Trip**
  History of rides (for reporting, not blocking logic).

---

## 3. Data Model (simplified)

```
Car
 â”œâ”€ car_id
 â”œâ”€ plate_no
 â”œâ”€ driver_name
 â”œâ”€ driver_phone
 â”œâ”€ model
 â”œâ”€ seater
 â””â”€ status (active/inactive)

Queue
 â”œâ”€ queue_id
 â”œâ”€ car_id
 â”œâ”€ seater
 â””â”€ queued_at

Trip
 â”œâ”€ trip_id
 â”œâ”€ car_id
 â”œâ”€ passenger_name
 â”œâ”€ passenger_count
 â”œâ”€ destination
 â”œâ”€ started_at
 â”œâ”€ ended_at (nullable, not required in MVP)
 â””â”€ status (active/completed â€“ optional)
```

---

## 4. Flow Logic

### A. Adding Car to Queue (QueuePal)

1. QueuePal selects car.
2. System checks:

   * Car is not already in queue.
   * Car is active.
3. If valid â†’ insert into queue (FIFO by `queued_at`).

```
[Car available] â†’ [Queue check] â†’ [Add to queue list]
```

---

### B. Passenger Requests Taxi

1. Passenger provides:

   * Name
   * Destination
   * Passenger count
2. System looks up the **queue of matching seater**.

   * Picks **first car (oldest entry)**.
   * Removes it from queue.
3. A new Trip record is created (for history).
4. Passenger sees:

   * Car model, Plate no, Driver name/phone.

```
Passenger Request
      â”‚
      â–¼
[Find matching queue]
      â”‚
      â–¼
[Pop 1st car from FIFO]
      â”‚
      â–¼
[Create Trip record + Return car details]
```

---

### C. Car Returns from Trip

* QueuePal manually adds car back to queue (same process as step A).
* No need to explicitly mark trip ended.
* Trip record is just historical.

```
Driver returns
     â”‚
     â–¼
QueuePal adds again â†’ Car re-enters FIFO
```

---

## 5. Visual Architecture

### Queues by Seater (FIFO)

```
4-Seater Queue: [Car A] â†’ [Car C] â†’ [Car F]
6-Seater Queue: [Car B] â†’ [Car D]
7-Seater Queue: [Car E]
```

### End-to-End Interaction

```
[Admin] -----------------+
                         |
                         v
                    [System State]
                         ^
[QueuePal] ---> [Add Car to Queue] 
                         ^
[Passenger] -> [Request Taxi] -> [Assign 1st Car] -> Car goes on Trip
```

---

## 6. Admin Views

* **Cars List**: Manage details, active/inactive.
* **Live Queues**: See FIFO order per seater.
* **Trips History**: Destination, car, driver, passenger info.
* **System Health**: API/db heartbeat, last activity log.

---

## 7. Error / Edge Handling

* Car already in queue â†’ Reject add.
* No car available in requested seater â†’ Return â€œNo taxi availableâ€.
* Passenger count > max seater â†’ Return error.
* Admin deactivates car â†’ Car cannot be queued again until activated.

---

## 8. MVP Principles

* **Simple**: Only 3 flows â€“ Queue in, Assign out, View state.
* **Human-driven correctness**: QueuePal ensures car is re-added only when itâ€™s back.
* **History preserved**: Trips are recorded, but donâ€™t affect real-time queueing.
* **Debuggable**: Every action logged (Car added, Car assigned, Trip created).

---
